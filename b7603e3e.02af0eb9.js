/*! For license information please see b7603e3e.02af0eb9.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{219:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return s})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return p})),n.d(t,"default",(function(){return m}));var a=n(1),i=n(9),r=(n(0),n(254)),o=n(261),c=n(260),s={title:"Components and Services",description:"Geocortex Web - Learn about Components and Services"},l={id:"web/concepts-components-services",title:"Components and Services",description:"Geocortex Web - Learn about Components and Services",source:"@site/docs/web/concepts-components-services.mdx",permalink:"/docs/web/concepts-components-services",editUrl:"https://github.com/geocortex/dev-center/edit/master/docs/web/concepts-components-services.mdx",sidebar:"web",previous:{title:"Commands and Operations",permalink:"/docs/web/concepts-commands-operations"},next:{title:"Events",permalink:"/docs/web/concepts-events"}},p=[{value:"Components",id:"components",children:[{value:"Component Models and Configuration",id:"component-models-and-configuration",children:[]}]},{value:"Services",id:"services",children:[{value:"Initialization and Cleanup",id:"initialization-and-cleanup",children:[]},{value:"Configuration",id:"configuration",children:[]}]},{value:"Creation and Initialization",id:"creation-and-initialization",children:[]},{value:"Next Steps",id:"next-steps",children:[]}],d={rightToc:p};function m(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},d,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Components")," and ",Object(r.b)("strong",{parentName:"p"},"services")," are the two basic building blocks of Geocortex Web. Components power the UI experience of Geocortex Web, and services provide the shared infrastructure and core logic that power app behavior."),Object(r.b)("h2",{id:"components"},"Components"),Object(r.b)("p",null,"In Geocortex Web, components are entities which implement UI/UX experiences and the associated logic. An example of a component is an I Want to Menu (IWTM). IWTMs participate in layout, implement custom behavior (display a list when clicked), and participate in the app config."),Object(r.b)("p",null,"Components are only ",Object(r.b)("strong",{parentName:"p"},"created")," if they participate in the layout - if no component definition exists in the layout, none will be created. Components are ",Object(r.b)("strong",{parentName:"p"},"initialized")," when they are activated."),Object(r.b)("h3",{id:"component-models-and-configuration"},"Component Models and Configuration"),Object(r.b)("p",null,"Every component has an associated model. This model functions as the underlying data source for the component, as well as providing a way to interface with the larger application, through ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/web/concepts-commands-operations"}),"commands, operations")," and shared services. This allows the component to solely worry about presentation concerns, and delegate data and application concerns to the underlying model. Models are also responsible for loading and consuming the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/web/concepts-app-config"}),"app config")," for the component."),Object(r.b)("h2",{id:"services"},"Services"),Object(r.b)("p",null,"In Geocortex Web, services represent a shared application-wide concern that needs to be accessed by many components or other services. There is only one instance of each service in the application. Interactions with services usually happen through the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/web/usecases-implement-command-operation#implement-the-custom-command-and-operation"}),"commands and operations they implement"),", but services can also be directly ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/web/sdk-service-injection"}),"injected")," into other services and component models."),Object(r.b)("h3",{id:"initialization-and-cleanup"},"Initialization and Cleanup"),Object(r.b)("p",null,"Sometimes, a service is required to perform initialization and cleanup actions, for example, to initialize dynamic data and cleanup dangling references. The ",Object(r.b)("inlineCode",{parentName:"p"},"ServiceBase")," class has two methods to achieve this:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"_onInitialize()"),", which can be overridden,"),Object(r.b)("li",{parentName:"ul"},"and ",Object(r.b)("inlineCode",{parentName:"li"},"destroy()"),", which can be implemented to facilitate cleanup.")),Object(r.b)("p",null,"The following service uses these methods to subscribe to an event and cleanup the event handler afterwards."),Object(r.b)("div",{className:"admonition admonition-important alert alert--info"},Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(r.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"important")),Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"Always call ",Object(r.b)("inlineCode",{parentName:"p"},"super._onInitialize()")," before any custom initialization logic."))),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),'import { ServiceBase } from "@geocortex/web/services";\nimport { MapEvent } from "@geocortex/viewer-framework/messaging/registry/map";\n\nexport default class CustomService extends ServiceBase {\n    handles: IHandle[] = [];\n\n    protected async _onInitialize(): Promise<void> {\n        await super._onInitialize();\n        this.handles.push(\n            this.messages.events.map.initialized.subscribe((e: MapEvent) => {\n                console.log(\n                    "Map Initialized, do your map dependent model setup here."\n                );\n            })\n        );\n        return;\n    }\n\n    destroy(): void {\n        this.handles.forEach((h) => h.remove());\n    }\n}\n')),Object(r.b)("h3",{id:"configuration"},"Configuration"),Object(r.b)("p",null,"Like components, services can be configured through the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/web/concepts-app-config"}),"app config"),". A service can participate in the config by extending the ",Object(r.b)("inlineCode",{parentName:"p"},"ConfigurableServiceBase")," class. The following example demonstrates a service with one configurable property ",Object(r.b)("inlineCode",{parentName:"p"},"name"),"."),Object(r.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(r.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"Check out the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/web/usecases-implement-component-participate-app-config"}),"article on creating a configurable component")," for more details on how configuration related code like ",Object(r.b)("inlineCode",{parentName:"p"},"_getSerializableProperties()")," works."))),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts",metastring:'title="src/services/CustomServiceWithConfig"',title:'"src/services/CustomServiceWithConfig"'}),'import {\n    ConfigurableServiceBase,\n    PropertyDefs,\n    serializable,\n} from "@geocortex/web/services";\nimport { ServiceModelProperties } from "@geocortex/web/models";\n\nexport interface CustomServiceProperties extends ServiceModelProperties {\n    name: string;\n}\n\n@serializable\nexport default class CustomServiceWithConfig extends ConfigurableServiceBase<\n    CustomServiceProperties\n> {\n    name: string;\n\n    async sayHello(): Promise<string> {\n        return `Hello, ${this.name}`;\n    }\n\n    protected _getSerializableProperties(): PropertyDefs<\n        CustomServiceProperties\n    > {\n        return {\n            ...super._getSerializableProperties(),\n            name: {\n                serializeModes: ["initial"],\n                default: "Noah",\n            },\n        };\n    }\n}\n')),Object(r.b)("h2",{id:"creation-and-initialization"},"Creation and Initialization"),Object(r.b)("p",null,"In general, components and services are created as needed at runtime in Geocortex Web, with a few exceptions."),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"First, all core services, like the ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/web/api-message-bus"}),"MessageBus"),", and services ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/web/usecases-implement-service#register-the-custom-service"}),"registered with ",Object(r.b)("inlineCode",{parentName:"a"},"loadOnStartup: true")),", will be initialized in parallel."),Object(r.b)("li",{parentName:"ol"},"Next, the components in the layout which are initially active will be initialized in parallel, along with their models and any ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/web/sdk-service-injection"}),"services they inject"),"."),Object(r.b)("li",{parentName:"ol"},"Finally, other services and components are initialized as needed, usually when a.) a command they implement is run or b.) they are activated explicitly in the layout.")),Object(r.b)("h2",{id:"next-steps"},"Next Steps"),Object(r.b)(c.a,{mdxType:"UseCaseContainer"},Object(r.b)(o.a,{title:"Implement a Custom Component",description:"Learn how to implement a custom component using the Geocortex Web SDK",link:"usecases-implement-component-with-ui",mdxType:"UseCaseCard"}),Object(r.b)(o.a,{title:"Implement a Custom Service",description:"Learn how to implement a custom service using the Geocortex Web SDK",link:"usecases-implement-service",mdxType:"UseCaseCard"})))}m.isMDXComponent=!0},254:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}));var a=n(0),i=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=i.a.createContext({}),p=function(e){var t=i.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c({},t,{},e)),n},d=function(e){var t=p(e.components);return i.a.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},b=Object(a.forwardRef)((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,o=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=p(n),b=a,u=d["".concat(o,".").concat(b)]||d[b]||m[b]||r;return n?i.a.createElement(u,c({ref:t},l,{components:n})):i.a.createElement(u,c({ref:t},l))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=b;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:a,o[1]=c;for(var l=2;l<r;l++)o[l]=n[l];return i.a.createElement.apply(null,o)}return i.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},255:function(e,t,n){var a;!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var r=typeof a;if("string"===r||"number"===r)e.push(a);else if(Array.isArray(a)&&a.length){var o=i.apply(null,a);o&&e.push(o)}else if("object"===r)for(var c in a)n.call(a,c)&&a[c]&&e.push(c)}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(a=function(){return i}.apply(t,[]))||(e.exports=a)}()},256:function(e,t,n){"use strict";var a=n(1),i=n(0),r=n.n(i),o=n(39),c=n(257),s=n(14),l=n.n(s);t.a=function(e){var t,n=e.to,s=e.href,p=n||s,d=Object(c.a)(p),m=Object(i.useRef)(!1),b=l.a.canUseIntersectionObserver;return Object(i.useEffect)((function(){return!b&&d&&window.docusaurus.prefetch(p),function(){b&&t&&t.disconnect()}}),[p,b,d]),p&&d?r.a.createElement(o.b,Object(a.a)({},e,{onMouseEnter:function(){m.current||(window.docusaurus.preload(p),m.current=!0)},innerRef:function(e){var n,a;b&&e&&d&&(n=e,a=function(){window.docusaurus.prefetch(p)},(t=new window.IntersectionObserver((function(e){e.forEach((function(e){n===e.target&&(e.isIntersecting||e.intersectionRatio>0)&&(t.unobserve(n),t.disconnect(),a())}))}))).observe(n))},to:p})):r.a.createElement("a",Object(a.a)({},e,{href:p}))}},257:function(e,t,n){"use strict";function a(e){return!1===/^(https?:|\/\/)/.test(e)}n.d(t,"a",(function(){return a}))},258:function(e,t,n){"use strict";n(259)("link",(function(e){return function(t){return e(this,"a","href",t)}}))},259:function(e,t,n){var a=n(12),i=n(13),r=n(26),o=/"/g,c=function(e,t,n,a){var i=String(r(e)),c="<"+t;return""!==n&&(c+=" "+n+'="'+String(a).replace(o,"&quot;")+'"'),c+">"+i+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(c),a(a.P+a.F*i((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",n)}},260:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(0),i=n.n(a),r=n(255),o=n.n(r),c=n(130),s=n.n(c);function l(e){var t=e.children;return i.a.createElement("div",{className:o()(s.a.root)},t)}},261:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));n(258);var a=n(256),i=n(0),r=n.n(i),o=n(255),c=n.n(o),s=n(131),l=n.n(s);function p(e){var t=e.title,n=e.description,i=e.link;return r.a.createElement("div",{className:c()("card-demo",l.a.root)},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card__header"},r.a.createElement("h3",null,t)),r.a.createElement("div",{className:"card__body"},r.a.createElement("p",null,n)),r.a.createElement("div",{className:"card__footer"},r.a.createElement(a.a,{className:"button button--secondary button--block",to:i},"Get Started"))))}}}]);